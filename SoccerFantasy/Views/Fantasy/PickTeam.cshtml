@{
    
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="~/lib/flag-icons-main/css/flag-icons.min.css" />
    <title>@ViewBag.Title</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <style>
        .container {
            position: relative;
        }

        .gk {
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }

        .defenders {
            position: absolute;
            top: 20%;
            left: 47%;
            transform: translateX(-50%);
            z-index: 2;
            display: flex;
            align-items: center;
        }

        .df {
            margin-left: 20px; /* Adjust the spacing between defenders */
        }

        .midfielders {
            position: absolute;
            top: 45%;
            left: 47%;
            transform: translateX(-50%);
            z-index: 2;
            display: flex;
            align-items : center;
        }

        .mf {
            margin-left: 45px; /* Adjust the spacing between defenders */
        }

        .attackers {
            position: absolute;
            top: 70%;
            left: 47%;
            transform: translateX(-50%);
            z-index: 2;
            display: flex;
        }

        .af {
            margin-left: 45px; /* Adjust the spacing between defenders */
        }
        /* You can adjust the styles as needed */
        .player img {
            width: 64px; /* Set the width of player images */
            height: 64px; /* Set the height of player images */
        }

        .soccer-field {
            position: relative;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div class="text-center row">
        <div class="container col">
            <img class="soccer-field" src="https://upload.wikimedia.org/wikipedia/commons/8/82/Soccer_Field_Transparant.svg" />
            @if (CurrentUser.Instance.fantasyTeam.players.Count() == 11)
            {
                <div class="gk">
                    <div>
                        <img class="player" src="@CurrentUser.Instance.fantasyTeam.players.First(p=> p.position == "GK").playerImageURL" alt="Goalkeeper" height="64" width="64" />
                        <p>@CurrentUser.Instance.fantasyTeam.players.First(p => p.position == "GK").name</p>
                    </div>

                </div>
                <div class="defenders">
                    @foreach (Player player in CurrentUser.Instance.fantasyTeam.players.Where(p => p.position == "DF").Take(4))
                    {
                        <div style="align-items: center;">
                            <img class="df img" src="@player.playerImageURL" alt="Defender 1" height="64" width="64" />
                            <p style="text-align: center;">@player.name</p>
                        </div>
                    }
                </div>
                <div class="midfielders">
                    @foreach (Player player in CurrentUser.Instance.fantasyTeam.players.Where(p => p.position == "MF").Take(4))
                    {
                        <div>
                            <img class="df img" src="@player.playerImageURL" alt="Defender 1" height="64" width="64" />
                            <p class="text-center">@player.name</p>
                        </div>
                    }
                </div>
                <div class="attackers">
                    @foreach (Player player in CurrentUser.Instance.fantasyTeam.players.Where(p => p.position == "FW").Take(2))
                    {
                        <div>
                            <img class="df img" src="@player.playerImageURL" alt="Defender 1" height="64" width="64" />
                            <p>@player.name</p>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="gk" style="align-items: center;" onclick="toggleTable('GK')">
                    <button>
                        <img class="player" src="https://cdn-icons-png.flaticon.com/64/2265/2265274.png" alt="Goalkeeper" height="64" width="64" />
                        <p>GK</p>
                    </button>

                </div>
                <div class="defenders">
                    @for (int i = 0; i < 4; i++)
                    {
                        <button style="align-items: center;" class="df" onclick="toggleTable('DF')">
                            <img class="player" src="https://cdn-icons-png.flaticon.com/64/2265/2265274.png" alt="Goalkeeper" height="64" width="64" />
                            <p>DF</p>
                        </button>
                    }
                </div>
                <div class="midfielders">
                    @for (int i = 0; i < 4; i++)
                    {
                        <button style="align-items: center;" class="mf" onclick="toggleTable('MF')">
                            <img class="player" src="https://cdn-icons-png.flaticon.com/64/2265/2265274.png" alt="Goalkeeper" height="64" width="64" />
                            <p>MF</p>
                        </button>
                    }
                </div>
                <div class="attackers">
                    @for (int i = 0; i < 2; i++)
                    {
                        <button style="align-items: center;" class="af" onclick="toggleTable('FW')">
                            <img class="player" src="https://cdn-icons-png.flaticon.com/64/2265/2265274.png" alt="Goalkeeper" height="64" width="64" />
                            <p>FW</p>
                        </button>

                    }
                </div>
            }
        </div>
        <div id="tableContainer" class="col" style="display:none;">
            <div class="table-container" style="max-height: 690px; overflow-y: auto; max-width: 100%">
                <table id="playersTable" style="max-width: 100%">
                    <thead style="background-color: gray; width: 100%;">
                        <tr style="max-width: 100%">
                            <th style="text-align:left">Name</th>
                            <th style="text-align:center">Position</th>
                            <th style="text-align: center">Nationality</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <button class="btn btn-primary">Save Changes</button>
</body>
</html>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    function toggleTable(position) {
        var tableContainer = document.getElementById("tableContainer");
        var playersTable = document.getElementById("playersTable");
        var tableBody = playersTable.getElementsByTagName('tbody')[0];
        tableBody.innerHTML = "";

        // Corrected syntax for $.getJSON
        $.getJSON(`https://localhost:7274/Players/getPlayersByPosition?position=${position}`, function (playersList) {
            for (var i = 0; i < playersList.length; i++) {
                var player = playersList[i];
                var row = tableBody.insertRow();

                var link = document.createElement('a');
                link.href = `#`;
                link.textContent = player.name;
                var nameCell = row.insertCell(0);
                
                link.addEventListener('click', function () {
                    debugger;
                    $.ajax({
                        type: "POST",
                        url: `https://localhost:7274/Players/addPlayerToFantasyTeam?id=${player.playerId}`,
                        success: function (response) {
                            console.log(response)
                            location.reload();
                        },
                        error: function (error) {
                            console.log(error)
                        }
                    })
                })
                nameCell.appendChild(link);

                //nameCell.textContent = player.name

                var positionCell = row.insertCell(1);
                positionCell.textContent = player.position

                var nationalityCell = row.insertCell(2);
                nationalityCell.textContent = player.nationality
            }
            // Toggle the display property
            if (tableContainer.style.display == "none") {
                tableContainer.style.display = "block";
            }
            //tableContainer.style.display = (tableContainer.style.display === "none") ? "block" : "none";
        });
}
    </script>
